# Juicy Filters Configuration
# Rules for identifying interesting findings in bug bounty results

rules:
  # High-value secrets and credentials
  - id: secrets_high_value
    desc: "High-value secrets and API keys"
    file_globs: ["**/*.js", "**/*.txt", "**/*.log", "**/*.json", "**/*.xml", "**/*.html"]
    regex:
      # AWS credentials
      - "AKIA[0-9A-Z]{16}"
      - "(?i)aws[_-]?secret[_-]?access[_-]?key[\\s:=\\\"']{0,5}([A-Za-z0-9/+=]{40})"
      - "(?i)aws[_-]?access[_-]?key[_-]?id[\\s:=\\\"']{0,5}(AKIA[0-9A-Z]{16})"
      
      # Google API keys
      - "AIza[0-9A-Za-z\\-_]{35}"
      - "(?i)google[_-]?api[_-]?key[\\s:=\\\"']{0,5}([A-Za-z0-9\\-_]{39})"
      
      # GitHub tokens
      - "ghp_[A-Za-z0-9]{36}"
      - "gho_[A-Za-z0-9]{36}"
      - "ghu_[A-Za-z0-9]{36}"
      - "ghs_[A-Za-z0-9]{36}"
      - "ghr_[A-Za-z0-9]{36}"
      
      # Stripe keys
      - "sk_live_[0-9a-zA-Z]{24}"
      - "pk_live_[0-9a-zA-Z]{24}"
      - "rk_live_[0-9a-zA-Z]{24}"
      
      # Private keys
      - "-----BEGIN [A-Z ]+PRIVATE KEY-----"
      - "-----BEGIN OPENSSH PRIVATE KEY-----"
      
      # JWT tokens
      - "eyJ[A-Za-z0-9_/+=]{10,}\\.[A-Za-z0-9_/+=]{10,}\\.[A-Za-z0-9_/+=]{10,}"
      
      # Database connection strings
      - "(?i)(mysql|postgresql|mongodb)://[^\\s]+"
      - "(?i)server=.{1,100};database=.{1,100};uid=.{1,100};pwd=.{1,100}"
    min_matches: 1
    max_matches: 50

  # API keys and tokens (general)
  - id: secrets_general
    desc: "General API keys and tokens"
    file_globs: ["**/*.js", "**/*.txt", "**/*.log", "**/*.json", "**/*.xml"]
    regex:
      - "(?i)(api[_-]?key|apikey|access[_-]?token|auth[_-]?token|secret[_-]?key)[\\s:=\\\"']{0,5}([A-Za-z0-9_\\-]{16,})"
      - "(?i)(bearer|authorization)[\\s:=\\\"']{0,5}([A-Za-z0-9_\\-\\.]{20,})"
      - "(?i)(password|pwd|pass)[\\s:=\\\"']{0,5}([A-Za-z0-9!@#$%^&*]{8,})"
      - "(?i)(client[_-]?secret|client[_-]?id)[\\s:=\\\"']{0,5}([A-Za-z0-9_\\-]{16,})"
    exclude:
      - "(?i)(example|test|demo|placeholder|your[_-]?api[_-]?key)"
    min_matches: 1
    max_matches: 100

  # Endpoints with parameters
  - id: endpoints_with_params
    desc: "Endpoints with interesting parameters"
    file_globs: ["**/endpoints/**/*.txt", "**/web/**/*.json", "**/katana*.txt"]
    regex:
      - "https?://[^\\s]+\\?[a-zA-Z0-9_]+=.*(&[a-zA-Z0-9_]+=.*)*"
      - "['\"`]/[^'\"`\\s]*\\?[a-zA-Z0-9_]+="
      - "(?i)\\?.*?(id|user|admin|debug|test|key|token|auth|login|email|password)="
      - "(?i)\\?.*?(callback|redirect|url|path|file|page|include|src)="
    min_matches: 1
    max_matches: 200

  # Admin and sensitive endpoints
  - id: admin_panels
    desc: "Admin panels and sensitive endpoints"
    file_globs: ["**/*.txt", "**/*.json", "**/katana*.txt", "**/httpx*.json"]
    regex:
      - "(?i)/admin[/\\s]?"
      - "(?i)/administrator[/\\s]?"
      - "(?i)/wp-admin[/\\s]?"
      - "(?i)/cpanel[/\\s]?"
      - "(?i)/phpmyadmin[/\\s]?"
      - "(?i)/manager[/\\s]?"
      - "(?i)/dashboard[/\\s]?"
      - "(?i)/control[_-]?panel[/\\s]?"
      - "(?i)/backend[/\\s]?"
      - "(?i)/console[/\\s]?"
      - "(?i)/api/admin[/\\s]?"
      - "(?i)/admin\\.php"
      - "(?i)/login\\.php"
    min_matches: 1
    max_matches: 50

  # Interesting HTTP status codes
  - id: interesting_status_codes
    desc: "Interesting HTTP status codes"
    file_globs: ["**/web/**/*.json", "**/httpx*.json"]
    regex:
      - "\"status_code\":\\s*(403|500|502|503|401|400)"
      - "\\[403\\]|\\[500\\]|\\[502\\]|\\[503\\]|\\[401\\]"
      - "\"status-code\":\\s*(403|500|502|503|401|400)"
    min_matches: 1
    max_matches: 100

  # Sensitive files and backups
  - id: sensitive_files
    desc: "Sensitive files and backups"
    file_globs: ["**/*.txt", "**/*.json", "**/katana*.txt"]
    regex:
      - "\\.git/config"
      - "\\.git/HEAD"
      - "\\.env\\.?[a-zA-Z]*"
      - "config\\.php"
      - "wp-config\\.php"
      - "\\.backup"
      - "\\.bak"
      - "\\.old"
      - "\\.sql"
      - "\\.db"
      - "\\.dump"
      - "robots\\.txt"
      - "sitemap\\.xml"
      - "\\.htaccess"
      - "\\.htpasswd"
      - "web\\.config"
      - "composer\\.json"
      - "package\\.json"
      - "\\.DS_Store"
      - "Thumbs\\.db"
    min_matches: 1
    max_matches: 100

  # Technology and framework indicators
  - id: technology_indicators
    desc: "Technology and framework indicators"
    file_globs: ["**/web/**/*.json", "**/httpx*.json", "**/technologies*.json"]
    regex:
      - "\"server\":\\s*\"([^\"]+)\""
      - "\"technology\":\\s*\"([^\"]+)\""
      - "X-Powered-By:\\s*([^\\r\\n]+)"
      - "\"title\":\\s*\"[^\"]*(?i)(admin|login|dashboard|panel|console|management)[^\"]*\""
      - "(?i)(php|asp|jsp|python|node\\.js|django|flask|laravel|wordpress|drupal|joomla)"
      - "\"webserver\":\\s*\"([^\"]+)\""
    min_matches: 1
    max_matches: 150

  # Potential vulnerabilities from Nuclei
  - id: nuclei_findings
    desc: "Nuclei vulnerability findings"
    file_globs: ["**/scans/*nuclei*.json"]
    regex:
      - "\"severity\":\\s*\"(critical|high|medium)\""
      - "\"template-id\":\\s*\"([^\"]+)\""
      - "\"name\":\\s*\"([^\"]+)\""
    json_path:
      - "$.[?(@.info.severity=='critical' || @.info.severity=='high')]"
    min_matches: 1
    max_matches: 100

  # Subdomains with interesting patterns
  - id: interesting_subdomains
    desc: "Subdomains with interesting patterns"
    file_globs: ["**/recon/*subfinder*.txt", "**/recon/*amass*.txt"]
    regex:
      - "(?i)(admin|api|dev|test|stage|staging|prod|internal|vpn|mail|email|ftp|ssh|db|database|backup|beta|alpha)\\..*"
      - "(?i)(jenkins|gitlab|jira|confluence|grafana|kibana|elastic|sonar|nexus)\\..*"
      - "(?i)(s3|aws|gcp|azure|cloud|bucket)\\..*"
      - "(?i)[0-9]{1,3}-[0-9]{1,3}-[0-9]{1,3}-[0-9]{1,3}\\..*"
    min_matches: 1
    max_matches: 200

  # Potential SSRF and file inclusion endpoints
  - id: ssrf_file_inclusion
    desc: "Potential SSRF and file inclusion endpoints"
    file_globs: ["**/endpoints/**/*.txt", "**/katana*.txt"]
    regex:
      - "(?i)\\?.*?(url|uri|path|file|page|include|src|redirect|callback|proxy|fetch|load)="
      - "(?i)/proxy\\?"
      - "(?i)/redirect\\?"
      - "(?i)/fetch\\?"
      - "(?i)/include\\?"
      - "(?i)/load\\?"
    min_matches: 1
    max_matches: 100

  # Email addresses and potential contacts
  - id: email_addresses
    desc: "Email addresses and potential contacts"
    file_globs: ["**/*.txt", "**/*.json", "**/*.js", "**/*.html"]
    regex:
      - "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
    exclude:
      - "(?i)(example|test|demo|noreply|no-reply)@"
      - "@(example|test)\\.com"
    min_matches: 1
    max_matches: 50

  # Potential XSS and injection points
  - id: xss_injection_points
    desc: "Potential XSS and injection points"
    file_globs: ["**/endpoints/**/*.txt", "**/katana*.txt"]
    regex:
      - "(?i)\\?.*?(q|query|search|term|keyword|input|data|content|message|comment|text)="
      - "(?i)\\?.*?(name|title|desc|description|about|bio)="
      - "(?i)/search\\?"
      - "(?i)/query\\?"
    min_matches: 1
    max_matches: 150